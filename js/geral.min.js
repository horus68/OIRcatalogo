//** OIR - OPAC.isisRBE
var lastHeader,lastpopup,lastmfn;function ShowExi(e,o,t,r,a,n,i,s){changecont(e);for(var l=r;l.length<6;)l="0"+l;var p,c=document.getElementById("vermais"+l);if(lastpopup==e&&(p="inline"==document.getElementById("cotas"+lastmfn).style.display),-1!=c.src.indexOf("plus.gif")){if(lastmfn){for(var u=lastmfn;u.length<6;)u="0"+u;document.getElementById("vermais"+u).src="../../imagens/picactions/plus.gif"}c.src="../../imagens/picactions/minus.gif",c.title="Esconder"}else{if(p)changecont("tab"+l+"1"),c.src="../../imagens/picactions/plus.gif",c.title="Expandir"}var m="/rbcatalogo/cgi/www.exe/[in=pesqexi.in]?base="+o+"&ut="+n+"&nut="+i+"&formato="+t+"&lim_inicio=1&limites=25&from="+r+"&to="+r+"&ent="+s+"&estab="+a,d="cotas"+r;null!=lastpopup||null!=lastmfn?lastpopup==e?"none"==document.getElementById("cotas"+lastmfn).style.display?(document.getElementById("cotas"+r).style.height="60px",document.getElementById("cotas"+lastmfn).style.display="inline"):document.getElementById("cotas"+lastmfn).style.display="none":(document.getElementById("cotas"+lastmfn).style.height="60px",document.getElementById("cotas"+lastmfn).style.display="none",document.getElementById("cotas"+r).style.display="inline"):document.getElementById("cotas"+r).style.display="inline",popup=window.open("",d,"toolbar=no,location=no,directories=no,status=no,scrollbars=no,resizable=no,width=500,height=60,left=100,top=50"),ndoc=popup.document,ndoc.location.href=m,lastpopup=e,lastmfn=r}function pad(e,o){for(var t=""+e;t.length<o;)t="0"+t;return t}function ShowRegs(e,o,t,r,a,n,i,s,l){var p="/rbcatalogo/cgi/www.exe/[in=pexiloc.in]?base="+t.toLowerCase()+"&expressao="+o+"&lim_inicio=1&limites=1000&ut="+r+"&nut="+a+"&mfn="+e+"&nex="+n+"&pos="+i+"&sigla="+s+"&ent="+l;"none"==document.getElementById("exemplares").style.display?(window.parent.document.getElementById("cotas"+e).style.height="124px",document.getElementById("exemplares").style.display="inline"):(window.parent.document.getElementById("cotas"+e).style.height="60px",document.getElementById("exemplares").style.height="115px",document.getElementById("exemplares").style.display="none"),popup=window.open("","exemplares","toolbar=no,location=no,directories=no,status=no,scrollbars=no,resizable=no,width=500,height=60,left=100,top=50"),ndoc=popup.document,ndoc.location.href=p}function expandir(e,o,t,r,a,n){var i=parseInt(e,10),s="",l="",p="tab"+e;l="";if(lastHeader){var c=lastHeader.id;c.lastIndexOf(p)>-1&&(l=c.substring(p.length)),s=0!=l?p+l:p+"1"}else s=p+"1";changecont(s,i),ShowExi(s,o,"showexi",i.toString(),t,r,a,n)}function encode_utf8(e){return unescape(encodeURIComponent(e))}function alterarPin(){popup=window.open("","altpin","toolbar=no,location=no,directories=no,status=no,scrollbars=yes,resizable=no,menubar=no,width=390,height=290,left=150%,top=150%"),ndoc=popup.document,ndoc.location.href="/rbcatalogo/admin/logleitor.asp?op=ap",window.focus&&popup.focus()}function adcoment(e,o){var t="/rbcatalogo/comentarios.asp?id="+e+"&mfn="+o;popup=window.open("","coment","toolbar=no,location=no,directories=no,status=no,scrollbars=yes,resizable=no,menubar=no,width=570,height=530,left=100,top=50"),ndoc=popup.document,ndoc.location.href=t,window.focus&&popup.focus()}function ver_comm(e,o,t){var r=window.location.protocol+window.location.hostname+"/../../../cgi/www.exe/[in=lstcomm.in]?expr="+o.replace(/@@/g,"")+"&id="+e+"&mfn="+o+"&nreg="+t;popup=window.open("","coment","toolbar=no,location=no,directories=no,status=no,scrollbars=yes,resizable=no,menubar=no,width=570,height=530,left=100,top=50"),ndoc=popup.document,ndoc.location.href=r,window.focus&&popup.focus()}function ShowMap(e,o,t,r,a){var n="/rbcatalogo/mostra_mapa.asp?long="+r+"&lat="+a+"&entidade="+encode_utf8(e)+"&morada="+encode_utf8(o)+"&concelho="+encode_utf8(t);popup=window.open("","map","toolbar=no,location=no,directories=no,status=no,scrollbars=yes,resizable=no,menubar=no,width=652,height=540,left=100,top=50"),ndoc=popup.document,ndoc.location.href=n,window.focus&&popup.focus()}function build_reservas(e,o){if(""!=o)var t="/rbcatalogo/cgi/www.exe/[in=pesqres.in]?base=reservas&expressao=REQ "+o+"&lim_inicio=1&limites=99999&ut="+escape(e)+"&nut="+o;else t="/rbcatalogo/cgi/www.exe/[in=pesqres.in]?base=reservas&expressao=REQ "+e+"&lim_inicio=1&limites=9999&ut="+e;popup=window.open("","res","toolbar=no,location=no,directories=no,status=no,scrollbars=yes,resizable=no,menubar=no,width=752,height=440,left=100,top=50"),ndoc=popup.document,ndoc.location.href=t,window.focus&&popup.focus()}function nova_reserva(e,o,t,r,a,n,i,s,l){var p="/rbcatalogo/cgi/www.exe/[in=newres.in]?base=reservas&titulo="+e+"&autor="+o+"&entidade="+t+"&nut="+(void 0==r?"":r)+"&sigla="+a+"&cota="+n+"&nreg="+i+"&ex="+s+"&ut="+l;popup=window.open("","novares","toolbar=no,location=no,directories=no,status=no,scrollbars=yes,resizable=no,width=652,height=200,left=200,top=100"),ndoc=popup.document,ndoc.location.href=p,window.focus&&popup.focus()}function act_reserva(e,o,t,r){var a=window.location.protocol+window.location.hostname+"/../cgi/www.exe/[in=updres.in]?base=reservas&from="+t+"&ex="+e+"&ut="+o+"&sigla="+r;popup=window.open("","novares","toolbar=no,location=no,directories=no,status=no,scrollbars=yes,resizable=no,width=652,height=200,left=200,top=100"),ndoc=popup.document,ndoc.location.href=a,window.focus&&popup.focus()}function regista_reserva(e,o){var t=void 0==e?"":e,r=window.location.protocol+window.location.hostname+"/../cgi/www.exe/[in=regres.in]?base=sumres&nut="+t+"&ut="+o;popup=window.open("","novares","toolbar=no,location=no,directories=no,status=no,scrollbars=yes,resizable=no,width=652,height=200,left=200,top=100"),ndoc=popup.document,ndoc.location.href=r,window.focus&&popup.focus()}function ShowReservas(){document.getElementById("basket").style.display="none"==document.getElementById("basket").style.display?"":"none"}function ConvUp(e){var o,t,r=0,a="",n="",i="";for(o=(a=(a=e.toUpperCase()).replace("Ø","ø")).length,r=0;r<o;r++)i=a.charAt(r),(t=escape(a.charAt(r))).lastIndexOf("%")>=0?p="%C1%C0%C2%C3%C4%C9%C8%CA%CB%CD%CC%CF%CE%D3%D2%D5%D4%D6%DA%D9%DC%C7%DB%E3%F5%E2%EA%EE%F4%FB%E1%E9%ED%F3%FA%E0%E8%EC%F2%F9%E4%EB%EF%F6%FC%C4%CB%D6%DC%E7%C6%FD%DD".lastIndexOf(t):p=-1,t=p>=0?"A  A  A  A  A  E  E  E  E  I  I  I  I  O  O  O  O  O  U  U  U  C  U  A  O  A  E  I  O  U  A  E  I  O  U  A  E  I  O  U  A  E  I  O  U  A  E  O  U  C  A  Y  Y".charAt(p):i,n=unescape(n+t);return n}function LTrim(e){var o=String.fromCharCode(32);if(t<1)return"";for(var t=e.length,r="",a=0;a<t;){if(e.charAt(a)!=o){r=e.substring(a,t);break}a+=1}return r}function RTrim(e){var o=String.fromCharCode(32),t=e.length,r="";if(t<0)return"";for(var a=t-1;a>-1;){if(e.charAt(a)!=o){r=e.substring(0,a+1);break}a-=1}return r}function validaIn(e){if(0==e.nk.value.lenght)return alert("O campo NOME não deve ficar vazio!"),e.nk.focus(),!1}function ValidaData(e){if(e.DP.value.length>4)return alert("Deve digitar 4 caracteres para representar a data."),e.DP.focus(),!1;var o="0123456789",t=e.DP.value,r=!0,a="";for(i=0;i<t.length;i++){for(ch=t.charAt(i),j=0;j<o.length&&ch!=o.charAt(j);j++);if(j==o.length){r=!1;break}a+=ch}if(!r)return alert("Para representar a data digite apenas números.\nEx:2001"),e.DP.focus(),!1;var n=a,s=parseInt(a);return""==n||s>="1000"&&s<="2050"?void 0:(alert("A data indicada deve estar entre 1000 e 2050."),e.DP.focus(),!1)}function ChkTermo(e){var o=0,t="";for(o=0;o<12;o++)1==e.PRFX.options[o].selected&&"PAL "==(t=e.PRFX.options[o].value+" ")&&(t="");e.expressao.value=ConvUp(t+e.termo.value)}function ChkTermo_alias(e){var o=0,t="";for(o=0;o<12;o++)1==e.PRFX.options[o].selected&&"PAL "==(t=e.PRFX.options[o].value+" ")&&(t="");e.expressao.value=t+e.termo.value}function ChkTermo_alfa(e){var o=0,t="";for(o=0;o<8;o++)1==e.PRFX.options[o].selected&&"PAL "==(t=e.PRFX.options[o].value+" ")&&(t="");e.expressao.value=ConvUp(t+e.termo.value)}function TrataCDU(e){var o=0,t=e;for(lista=new Array("-",":","/","(",")","#","*","%2B","+","=",'"',"&#34;","&quot;","&#43;"),o=0;o<14;o++)if(p=e.indexOf(lista[o]),p>=0){t=e.substring(0,p);break}return t}function ChkMeses(e){var o,t,r,a,n;for(a=(a=(r=new Date).getYear())<2e3?"19"+a:a,n=r.getMonth(),o=0;o<12;o++)"1"==e.R1[o].checked&&(t=e.R1[o].value);null==t&&(t=n+1),t=parseInt(t)<10?"0"+t:t,e.expressao.value="DT "+a+t+"$"}function ChkDP(e){var o,t;o=(o=(new Date).getYear())<2e3?"19"+o:o,""==(t=e.DP.value)?t=o:o="",e.expressao.value="(TDOC AM) AND (DP "+t+o+")"}function FindReplace(e,o,t){var r,a,n=0,i="";for(r=e.length,n=0;n<r;n++)(a=e.charAt(n))==o&&(a=t),i+=a;return i}function FindRepChar(e,o,t){var r,a,n=0,i=e,s="";for(r=e.length,n=0;n<r;n++)(a=i.charAt(n))==o&&(a=t),s+=a;return s}function FindReplace_2(e,o,t){for(var r=e,a=r.length,n=0;n>-1;)(n=r.substring(0,a).lastIndexOf(o))>=0&&(r=r.substring(0,n)+t+r.substring(n+o.length,r.length),a=n-1);return r}function Dim_Campo(e){return!(e.length<2)||(alert("Deve digitar no mínimo 2 caracteres para cada termo indicado."),!1)}function ChkChars(e){var o=0,t="";for(e=(e=e.toUpperCase()).replace("Ø","ø"),lista=new Array("+","*","^"," AND "," OR "," NOT "," AND NOT "," (F) "," (G) ","(",")"),o=0;o<11;o++)if(e.indexOf(lista[o])>=0){t='"';break}return t+e+t}function ChkChars_2(e){var o="",t=e;for(t=(t=t.toUpperCase()).replace("Ø","ø"),lista=new Array("+","%2B","*","^"," AND "," OR "," NOT "," AND NOT ","(",")"),i=0;i<12;i++)if(t.indexOf(lista[i])>=0){o='"';break}return o+t+o}function LimpaMais(e){var o=0,t=e.length,r="",a="";for(o=0;o<t;o++)"+"==(a=e.charAt(o))&&(a="%2B")," "==a&&(a="%20"),r+=a;return r}function ValidaExpress(e){_NTermos=11,_LTermos=7,_OP=new Array(_LTermos),_PRFX=new Array(_LTermos),_Termo=new Array(_LTermos);var o,t,r=0,a=0,n="",i="";if(tmp="",""!=e.Termo1.value){if(e.Termo1.focus(),0==Dim_Campo(e.Termo1.value))return!1;for(a=0,r=0;r<_NTermos;r++)1==e.PRFX1.options[r].selected&&(_PRFX[a]=e.PRFX1.options[r].value,_PRFX[a]="PAL"==_PRFX[a]?"":_PRFX[a]+" ");e.TR1.value=1==e.TR1.checked?e.TR1.value:"",_Termo[a]=ChkChars(_PRFX[a]+e.Termo1.value+e.TR1.value)}if(""!=e.Termo2.value){if(e.Termo2.focus(),0==Dim_Campo(e.Termo2.value))return!1;for(a=1,r=0;r<3;r++)1==e.OP2.options[r].selected&&(_OP[a]=e.OP2.options[r].value);for(r=0;r<_NTermos;r++)1==e.PRFX2.options[r].selected&&(_PRFX[a]=e.PRFX2.options[r].value,_PRFX[a]="PAL"==_PRFX[a]?"":_PRFX[a]+" ");e.TR2.value=1==e.TR2.checked?e.TR2.value:"",_Termo[a]=ChkChars(_PRFX[a]+e.Termo2.value+e.TR2.value)}if(""!=e.Termo3.value){if(e.Termo3.focus(),0==Dim_Campo(e.Termo3.value))return!1;for(a=2,r=0;r<3;r++)1==e.OP3.options[r].selected&&(_OP[a]=e.OP3.options[r].value);for(r=0;r<_NTermos;r++)1==e.PRFX3.options[r].selected&&(_PRFX[a]=e.PRFX3.options[r].value,_PRFX[a]="PAL"==_PRFX[a]?"":_PRFX[a]+" ");e.TR3.value=1==e.TR3.checked?e.TR3.value:"",_Termo[a]=ChkChars(_PRFX[a]+e.Termo3.value+e.TR3.value)}if(""!=e.Termo4.value){if(e.Termo4.focus(),0==Dim_Campo(e.Termo4.value))return!1;for(a=3,r=0;r<3;r++)1==e.OP4.options[r].selected&&(_OP[a]=e.OP4.options[r].value);for(r=0;r<_NTermos;r++)1==e.PRFX4.options[r].selected&&(_PRFX[a]=e.PRFX4.options[r].value,_PRFX[a]="PAL"==_PRFX[a]?"":_PRFX[a]+" ");e.TR4.value=1==e.TR4.checked?e.TR4.value:"",_Termo[a]=ChkChars(_PRFX[a]+e.Termo4.value+e.TR4.value)}if(""!=e.Termo5.value){if(e.Termo5.focus(),0==Dim_Campo(e.Termo5.value))return!1;for(a=4,r=0;r<3;r++)1==e.OP5.options[r].selected&&(_OP[a]=e.OP5.options[r].value);for(r=0;r<_NTermos;r++)1==e.PRFX5.options[r].selected&&(_PRFX[a]=e.PRFX5.options[r].value,_PRFX[a]="PAL"==_PRFX[a]?"":_PRFX[a]+" ");e.TR5.value=1==e.TR5.checked?e.TR5.value:"",_Termo[a]=ChkChars(_PRFX[a]+e.Termo5.value+e.TR5.value)}if(""!=e.Termo6.value){if(e.Termo6.focus(),0==Dim_Campo(e.Termo6.value))return!1;for(a=5,r=0;r<3;r++)1==e.OP6.options[r].selected&&(_OP[a]=e.OP6.options[r].value);for(r=0;r<_NTermos;r++)1==e.PRFX6.options[r].selected&&(_PRFX[a]=e.PRFX6.options[r].value,_PRFX[a]="PAL"==_PRFX[a]?"":_PRFX[a]+" ");e.TR6.value=1==e.TR6.checked?e.TR6.value:"",_Termo[a]=ChkChars(_PRFX[a]+e.Termo6.value+e.TR6.value)}if(""!=e.Termo7.value){if(e.Termo7.focus(),0==Dim_Campo(e.Termo7.value))return!1;for(a=6,r=0;r<3;r++)1==e.OP7.options[r].selected&&(_OP[a]=e.OP7.options[r].value);for(r=0;r<_NTermos;r++)1==e.PRFX7.options[r].selected&&(_PRFX[a]=e.PRFX7.options[r].value,_PRFX[a]="PAL"==_PRFX[a]?"":_PRFX[a]+" ");e.TR7.value=1==e.TR7.checked?e.TR7.value:"",_Termo[a]=ChkChars(_PRFX[a]+e.Termo7.value+e.TR7.value)}for(i="",r=0;r<_NTermos-1;r++)null!=_Termo[r]&&(0,i=""!=i?i+" "+_OP[r]+" "+_Termo[r]:_Termo[r]);for("",r=0;r<16;r++)1==e.TDOC.options[r].selected&&(n="XX"==(n=e.TDOC.options[r].value)?"":"TDOC "+n+" ");return o=""!=e.DP.value?"DP "+e.DP.value:"",t=""!=n&&""!=o?n+" AND "+o:n+o,tmp=ConvUp(""!=i&&""!=t?"("+i+") AND ("+t+")":i+t),""==tmp?(alert("ATENÇÃO! Não existem termos para pesquisa!\n\nDeve preencher pelo menos um dos campos indicados\n"),!1):(e.expressao.value=tmp,!0)}function ValidaExpress_alias(e){_NTermos=10,_LTermos=7,_OP=new Array(_LTermos),_PRFX=new Array(_LTermos),_Termo=new Array(_LTermos);var o,t,r=0,a=0,n="",i="";if(tmp="",""!=e.Termo1.value){if(e.Termo1.focus(),0==Dim_Campo(e.Termo1.value))return!1;for(a=0,r=0;r<_NTermos;r++)1==e.PRFX1.options[r].selected&&(_PRFX[a]=e.PRFX1.options[r].value,_PRFX[a]="PAL"==_PRFX[a]?"":_PRFX[a]+" ");e.TR1.value=1==e.TR1.checked?e.TR1.value:"",_Termo[a]=ChkChars(_PRFX[a]+e.Termo1.value+e.TR1.value)}if(""!=e.Termo2.value){if(e.Termo2.focus(),0==Dim_Campo(e.Termo2.value))return!1;for(a=1,r=0;r<3;r++)1==e.OP2.options[r].selected&&(_OP[a]=e.OP2.options[r].value);for(r=0;r<_NTermos;r++)1==e.PRFX2.options[r].selected&&(_PRFX[a]=e.PRFX2.options[r].value,_PRFX[a]="PAL"==_PRFX[a]?"":_PRFX[a]+" ");e.TR2.value=1==e.TR2.checked?e.TR2.value:"",_Termo[a]=ChkChars(_PRFX[a]+e.Termo2.value+e.TR2.value)}if(""!=e.Termo3.value){if(e.Termo3.focus(),0==Dim_Campo(e.Termo3.value))return!1;for(a=2,r=0;r<3;r++)1==e.OP3.options[r].selected&&(_OP[a]=e.OP3.options[r].value);for(r=0;r<_NTermos;r++)1==e.PRFX3.options[r].selected&&(_PRFX[a]=e.PRFX3.options[r].value,_PRFX[a]="PAL"==_PRFX[a]?"":_PRFX[a]+" ");e.TR3.value=1==e.TR3.checked?e.TR3.value:"",_Termo[a]=ChkChars(_PRFX[a]+e.Termo3.value+e.TR3.value)}if(""!=e.Termo4.value){if(e.Termo4.focus(),0==Dim_Campo(e.Termo4.value))return!1;for(a=3,r=0;r<3;r++)1==e.OP4.options[r].selected&&(_OP[a]=e.OP4.options[r].value);for(r=0;r<_NTermos;r++)1==e.PRFX4.options[r].selected&&(_PRFX[a]=e.PRFX4.options[r].value,_PRFX[a]="PAL"==_PRFX[a]?"":_PRFX[a]+" ");e.TR4.value=1==e.TR4.checked?e.TR4.value:"",_Termo[a]=ChkChars(_PRFX[a]+e.Termo4.value+e.TR4.value)}if(""!=e.Termo5.value){if(e.Termo5.focus(),0==Dim_Campo(e.Termo5.value))return!1;for(a=4,r=0;r<3;r++)1==e.OP5.options[r].selected&&(_OP[a]=e.OP5.options[r].value);for(r=0;r<_NTermos;r++)1==e.PRFX5.options[r].selected&&(_PRFX[a]=e.PRFX5.options[r].value,_PRFX[a]="PAL"==_PRFX[a]?"":_PRFX[a]+" ");e.TR5.value=1==e.TR5.checked?e.TR5.value:"",_Termo[a]=ChkChars(_PRFX[a]+e.Termo5.value+e.TR5.value)}if(""!=e.Termo6.value){if(e.Termo6.focus(),0==Dim_Campo(e.Termo6.value))return!1;for(a=5,r=0;r<3;r++)1==e.OP6.options[r].selected&&(_OP[a]=e.OP6.options[r].value);for(r=0;r<_NTermos;r++)1==e.PRFX6.options[r].selected&&(_PRFX[a]=e.PRFX6.options[r].value,_PRFX[a]="PAL"==_PRFX[a]?"":_PRFX[a]+" ");e.TR6.value=1==e.TR6.checked?e.TR6.value:"",_Termo[a]=ChkChars(_PRFX[a]+e.Termo6.value+e.TR6.value)}if(""!=e.Termo7.value){if(e.Termo7.focus(),0==Dim_Campo(e.Termo7.value))return!1;for(a=6,r=0;r<3;r++)1==e.OP7.options[r].selected&&(_OP[a]=e.OP7.options[r].value);for(r=0;r<_NTermos;r++)1==e.PRFX7.options[r].selected&&(_PRFX[a]=e.PRFX7.options[r].value,_PRFX[a]="PAL"==_PRFX[a]?"":_PRFX[a]+" ");e.TR7.value=1==e.TR7.checked?e.TR7.value:"",_Termo[a]=ChkChars(_PRFX[a]+e.Termo7.value+e.TR7.value)}for(i="",r=0;r<_NTermos-1;r++)null!=_Termo[r]&&(0,i=""!=i?i+" "+_OP[r]+" "+_Termo[r]:_Termo[r]);for("",r=0;r<16;r++)1==e.TDOC.options[r].selected&&(n="XX"==(n=e.TDOC.options[r].value)?"":"TDOC "+n+" ");return o=""!=e.DP.value?"DP "+e.DP.value:"",t=""!=n&&""!=o?n+"AND "+o:n+o,tmp=ConvUp(""!=i&&""!=t?"("+i+") AND ("+t+")":i+t),""==tmp?(alert("ATENÇÃO! Não existem termos para pesquisa!\n\nDeve preencher pelo menos um dos campos indicados\n"),!1):(e.expressao.value=tmp,!0)}function ValidaExpress_thes(e){_NTermos=8,_LTermos=7,_OP=new Array(_LTermos),_PRFX=new Array(_LTermos),_Termo=new Array(_LTermos);var o=0,t=0,r="";if(tmp="",""!=e.Termo1.value){if(e.Termo1.focus(),0==Dim_Campo(e.Termo1.value))return!1;for(t=0,o=0;o<_NTermos;o++)1==e.PRFX1.options[o].selected&&(_PRFX[t]=e.PRFX1.options[o].value,_PRFX[t]="PAL"==_PRFX[t]?"":_PRFX[t]+" ");e.TR1.value=1==e.TR1.checked?e.TR1.value:"",_Termo[t]=ChkChars(_PRFX[t]+e.Termo1.value+e.TR1.value)}if(""!=e.Termo2.value){if(e.Termo2.focus(),0==Dim_Campo(e.Termo2.value))return!1;for(t=1,o=0;o<3;o++)1==e.OP2.options[o].selected&&(_OP[t]=e.OP2.options[o].value);for(o=0;o<_NTermos;o++)1==e.PRFX2.options[o].selected&&(_PRFX[t]=e.PRFX2.options[o].value,_PRFX[t]="PAL"==_PRFX[t]?"":_PRFX[t]+" ");e.TR2.value=1==e.TR2.checked?e.TR2.value:"",_Termo[t]=ChkChars(_PRFX[t]+e.Termo2.value+e.TR2.value)}if(""!=e.Termo3.value){if(e.Termo3.focus(),0==Dim_Campo(e.Termo3.value))return!1;for(t=2,o=0;o<3;o++)1==e.OP3.options[o].selected&&(_OP[t]=e.OP3.options[o].value);for(o=0;o<_NTermos;o++)1==e.PRFX3.options[o].selected&&(_PRFX[t]=e.PRFX3.options[o].value,_PRFX[t]="PAL"==_PRFX[t]?"":_PRFX[t]+" ");e.TR3.value=1==e.TR3.checked?e.TR3.value:"",_Termo[t]=ChkChars(_PRFX[t]+e.Termo3.value+e.TR3.value)}if(""!=e.Termo4.value){if(e.Termo4.focus(),0==Dim_Campo(e.Termo4.value))return!1;for(t=3,o=0;o<3;o++)1==e.OP4.options[o].selected&&(_OP[t]=e.OP4.options[o].value);for(o=0;o<_NTermos;o++)1==e.PRFX4.options[o].selected&&(_PRFX[t]=e.PRFX4.options[o].value,_PRFX[t]="PAL"==_PRFX[t]?"":_PRFX[t]+" ");e.TR4.value=1==e.TR4.checked?e.TR4.value:"",_Termo[t]=ChkChars(_PRFX[t]+e.Termo4.value+e.TR4.value)}if(""!=e.Termo5.value){if(e.Termo5.focus(),0==Dim_Campo(e.Termo5.value))return!1;for(t=4,o=0;o<3;o++)1==e.OP5.options[o].selected&&(_OP[t]=e.OP5.options[o].value);for(o=0;o<_NTermos;o++)1==e.PRFX5.options[o].selected&&(_PRFX[t]=e.PRFX5.options[o].value,_PRFX[t]="PAL"==_PRFX[t]?"":_PRFX[t]+" ");e.TR5.value=1==e.TR5.checked?e.TR5.value:"",_Termo[t]=ChkChars(_PRFX[t]+e.Termo5.value+e.TR5.value)}if(""!=e.Termo6.value){if(e.Termo6.focus(),0==Dim_Campo(e.Termo6.value))return!1;for(t=5,o=0;o<3;o++)1==e.OP6.options[o].selected&&(_OP[t]=e.OP6.options[o].value);for(o=0;o<_NTermos;o++)1==e.PRFX6.options[o].selected&&(_PRFX[t]=e.PRFX6.options[o].value,_PRFX[t]="PAL"==_PRFX[t]?"":_PRFX[t]+" ");e.TR6.value=1==e.TR6.checked?e.TR6.value:"",_Termo[t]=ChkChars(_PRFX[t]+e.Termo6.value+e.TR6.value)}if(""!=e.Termo7.value){if(e.Termo7.focus(),0==Dim_Campo(e.Termo7.value))return!1;for(t=6,o=0;o<3;o++)1==e.OP7.options[o].selected&&(_OP[t]=e.OP7.options[o].value);for(o=0;o<_NTermos;o++)1==e.PRFX7.options[o].selected&&(_PRFX[t]=e.PRFX7.options[o].value,_PRFX[t]="PAL"==_PRFX[t]?"":_PRFX[t]+" ");e.TR7.value=1==e.TR7.checked?e.TR7.value:"",_Termo[t]=ChkChars(_PRFX[t]+e.Termo7.value+e.TR7.value)}for(r="",o=0;o<_NTermos-1;o++)null!=_Termo[o]&&(0,r=""!=r?r+" "+_OP[o]+" "+_Termo[o]:_Termo[o]);return"","",tmp=ConvUp(r+""),""==tmp?(alert("ATENÇÃO! Não existem termos para pesquisa!\n\nDeve preencher pelo menos um dos campos indicados\n"),!1):(e.expressao.value=tmp,!0)}function ValidaExpress_3(form){var cont=0,i=0,t=0,_tdoc="",_dp="",part1="",part2="";for(tmp="",temp="",i=0;i<16;i++)1==form.TDOC.options[i].selected&&(_tdoc=form.TDOC.options[i].value,_tdoc="XX"==_tdoc?"":"TDOC "+_tdoc+" ");if(_dp=""!=form.DP.value?"DP "+form.DP.value:"",temp=""!=_tdoc&&""!=_dp?_tdoc+"AND "+_dp:_tdoc+_dp,part1=LTrim(RTrim(form.termo.value)),part1=ConvUp(FindReplace_2(part1,"  "," ")),tmp=ConvUp("("+part1+")"+(""==temp?"":" AND ("+temp+")")),""==tmp)return alert("ATENÇÃO! Não existem termos para pesquisa!\n\nDeve definir uma expressão de pesquisa.\nPara mais informações consulte o guia do utilizador."),!1;if(""!=part1){part1=part1.replace(/ +(?= )/g,""),part1=part1.replace(/ AND NOT /g,"-"),part1=part1.replace(/ AND /g,"+"),part1=part1.replace(/ OR /g," "),part1=part1.replace(/\s\+\s/g,"(*)"),part1=part1.replace(/\+\s/g,"(*)"),part1=part1.replace(/\s\+/g,"(*)"),part1=part1.replace(/\+/g,"(*)"),part1=part1.replace(/\s\-\s/g,"(^)"),part1=part1.replace(/\s\-/g,"(^)"),part1=part1.replace(/\-\s/g,"(^)"),part1=part1.replace(/\-/g,"(^)");var par=part1.match(/\b(\w+)\b/g).length;if(par>1){var opr=part1.match(/\^|\s|\*/g).length;if(par!=opr+1)return alert("Erro na expressão de pesquisa!"),!1}if(dblq=part1.match(/"(.*?)"/g),dblq)for(i=0;i<dblq.length;i++){if(dblq[i].match(/\$/g))return alert("Erro na expressão de pesquisa!"),!1;eval("part1=part1.replace(/("+dblq[i]+")/, '"+dblq[i].replace(/\s/g,"~$~")+"')"),eval("part1=part1.replace(/-"+dblq[i]+"/, '-"+dblq[i]+"')")}var p1=part1.match(/\s|\(\^\)|\(\*\)/g),tb=part1.split(/\s|\(\^\)|\(\*\)/g);for(part1=tb[0].match(/"(.*?)"/g)?tb[0]:tb[0]+"$",i=1;i<tb.length;i++)" "==p1[i-1]?part1="("+part1+") or ("+(tb[i].match(/"(.*?)"/g)?tb[i]:tb[i]+"$")+")":"(*)"==p1[i-1]?part1="("+part1+")"+p1[i-1]+"("+(tb[i].match(/"(.*?)"/g)?tb[i]:tb[i]+"$")+")":"(^)"==p1[i-1]&&(part1=part1+p1[i-1]+"("+(tb[i].match(/"(.*?)"/g)?tb[i]:tb[i]+"$")+")");part1=part1.replace(/~/g," "),part1=part1.replace(/\(\^\)/g," and not "),part1=part1.replace(/\(\*\)/g," and "),part1=part1.replace(/"/g,"");var pa=part1.match(/\(/g);if(pa)var l=pa.length;else var l=0;var pf=part1.match(/\)/g);if(pf)var r=pa.length;else var r=0}return tmp=ConvUp(part1+(""==part1?"$":"")+(""==temp?"":" AND ("+temp+")")),form.expressao.value=tmp,!0}function ValidaExpress_4(e){var o,t,r=0,a="",n="",i="";for(r=0;r<16;r++)1==e.TDOC.options[r].selected&&(n="XX"==(n=e.TDOC.options[r].value)?"":"TDOC "+n+" ");return o=""!=e.DP.value?"DP "+e.DP.value:"",""!=(i=""!=n&&""!=o?n+" AND "+o:n+o)&&(i="("+i+")"),""!=(a=e.termo.value)&&(a="("+a+")"),""==(t=ConvUp(""!=a&&""!=i?i+" AND "+a:i+a))?(alert("ATENÇÃO! Não existem termos para pesquisa!\n\nDeve definir uma expressão de pesquisa.\nPara mais informações consulte o guia do utilizador."),!1):(e.expressao.value=t,!0)}function ValidaExpress_5(form){_OP=new Array(1),_Termo=new Array(1);var cont=0,i=0,t=0,_tdoc="",_dp="",part1="",part2="";for(tmp="",temp="",i=0;i<16;i++)1==form.TDOC.options[i].selected&&(_tdoc=form.TDOC.options[i].value,_tdoc="XX"==_tdoc?"":"TDOC "+_tdoc+" ");if(_dp=""!=form.DP.value?"DP "+form.DP.value:"",temp=""!=_tdoc&&""!=_dp?_tdoc+"AND "+_dp:_tdoc+_dp,part1=LTrim(RTrim(form.termo.value)),part1=FindReplace_2(part1,"  "," "),""==part1)return alert("ATENÇÃO! Não foi indicada uma etiqueta para pesquisa!\n\nPara mais informações consulte o guia do utilizador."),!1;if(part1=part1.replace(/ +(?= )/g,""),part1=part1.replace(/ OR /g," "),dblq=part1.match(/"(.*?)"/g),dblq)for(i=0;i<dblq.length;i++){if(dblq[i].match(/\$/g))return alert("Erro na expressão de pesquisa!"),!1;eval("part1=part1.replace(/("+dblq[i]+")/, '"+dblq[i].replace(/\s/g,"~")+"')")}var tb=part1.split(/\s/g);for(part1="PCH "+(tb[0].match(/"(.*?)"/g)?tb[0]:tb[0]+"$"),i=1;i<tb.length;i++)part1="("+part1+") or (PCH "+(tb[i].match(/"(.*?)"/g)?tb[i]:tb[i]+"$")+")";return part1=part1.replace(/~/g," "),part1=part1.replace(/"/g,""),tmp=ConvUp(part1+(""==temp?"":' AND ("'+temp+'")')),form.expressao.value=tmp,!0}function ChkVer(){return!("Netscape"==navigator.appName&&navigator.appVersion.substring(0,4)<"5.00"||"Microsoft Internet Explorer"==navigator.appName&&navigator.appVersion.substring(0,1)<"4")}function MailIt(base,formato,express,mfn1,limites){var texto="Envio do resultado de uma pesquisa por Email",infile="mailit.in";express=FindRepChar(express,"+","OR");var loc="/rbcatalogo/cgi/www.exe/[in="+infile+"]?base="+base+"&formato="+formato+"&expressao="+express+"&lim_inicio="+mfn1+"&limites="+limites;eval('window.showModalDialog(loc,"","help:0;resizable:1;dialogWidth:535px;dialogHeight:400px;status:0;")')}function Imprimir(e,o,t,r,a,n){var i;t=LimpaMais(t),i="print.in";var s=window.location.protocol+window.location.hostname+"/../cgi/www.exe/[in="+i+"]?base="+e+"&formato="+o+"&expressao="+t+"&lim_inicio="+r+"&limites="+a+"&entidade="+n;popup=window.open("","ID","toolbar=no,location=no,directories=no,status=no,scrollbars=yes,resizable=yes,width=670,height=450,left=50,top=100"),ndoc=popup.document,ndoc.location.href=s}var NS4=document.layers?1:0,IE=document.all?1:0,DOM=0;function changecont(e,o){if(DOM){lastHeader&&(lastHeader.style.background="#f2f2f2",lastHeader.style.fontWeight="normal");var t=document.getElementById(e);return t.style.background="silver",t.style.fontWeight="bold",lastHeader=document.getElementById(e),!1}return IE?(lastHeader&&(lastHeader.style.background="#f2f2f2",lastHeader.style.fontWeight="normal"),document.all[e].style.background="silver",document.all[e].style.fontWeight="bold",lastHeader=document.all[e],!1):NS4?(lastHeader&&(lastHeader.bgColor="white"),document.layers[e].bgColor="silver",lastHeader=document.layers[e],!1):(window.location="#A"+target,!0)}function popitup(){var e=window.location.protocol+window.location.hostname+"/../cgi/www.exe/[in=pedemp.in]?base="+base+"&formato="+formato+"&expressao="+express+"&lim_inicio=1&limites=25&from="+mfn1+"&to="+mfn1;return popup=window.open(e,"ID","toolbar=no,location=no,directories=no,status=no,scrollbars=no,resizable=no,width=450,height=260,left=150,top=110"),window.focus&&popup.focus(),!1}function popunimarc(e,o,t,r,a){var n=window.location.protocol+window.location.hostname+"/../cgi/www.exe/[in=pesquni.in]?base="+e+"&formato="+t+"&expressao="+o+"&lim_inicio=1&limites=25&from="+r+"&to="+r+"&op="+a;popup=window.open(n,"ID","toolbar=no,location=no,directories=no,status=no,scrollbars=yes,resizable=yes,width=550,height=280,left=200,top=110")}function Pedido_Empr(sigla,descri,email,nome,origem,mailori,morada,express,titulo,nreg,p){var texto="Envio de pedido de empréstimo por Email";if(p){var loc=window.location.protocol+window.location.hostname+"/../pedidoemp.php?sigla="+sigla+"&descri="+unescape(descri)+"&email="+unescape(email)+"&titulo="+unescape(titulo)+"&expressao="+express+"&nome="+nome+"&origem="+unescape(origem)+"&mailori="+unescape(mailori)+"&morada="+unescape(morada)+"&nreg="+nreg;document.all?window.showModalDialog(loc,"","help:0;resizable:1;dialogWidth:580px;dialogHeight:590px;status:1;"):eval("window.open(loc,'','Width:580px;Height:590px')")}else alert("Operação não permitida a utilizadores anónimos!!!")}parseInt(navigator.appVersion)>=5&&(DOM=1);var loadImage=function(e,o,t,r){var a=stripEAN(t),n=(mod10CheckDigit(a),new Image(e,o));url="http://www.biblioteca.cm-feira.pt:8080/hipres/Imagens/livros/p"+LTrim(RTrim(t.substring(0,13)))+".jpg",n.onerror=function(e){this.style.height="120px",this.style.width="160px",this.src="http://ec2.images-amazon.com/images/P/"+LTrim(RTrim(t.substring(0,13)))+".01._AA240_SCLZZZZZZZ_.jpg"},n.src=url,n.style.visibility="hidden";var i=document.createElement("div");i.setAttribute("id","molde");var s=i.style;s.width=n.width+"px",s.height=n.height+"px",document.getElementById(r).appendChild(i),i.appendChild(n),n.onload=function(){this&&""!=this.src&&(this.style.visibility="visible")}};function mod10CheckDigit(e){for(var o=0,t=0,r=e.length;r>=1;--r)t=parseInt(e.substring(r-1,r)),o+=r%2==0?3*t:1*t;return(10-o%10)%10}function stripEAN(e){return e.substring(0,9)}function ImageLoadFailed(e){document.layers,document.all;var o=0;parseInt(navigator.appVersion)>=5&&(o=1),o?e.style.visibility="hidden":window.event.srcElement.style.display="none"}var version4="4"==navigator.appVersion.charAt(0),popupHandle;function closePopup(){null==popupHandle||popupHandle.closed||popupHandle.close()}function displayPopup(e,o,t,r,a,n){var i,s,l,p,c,u,m="toolbar=0,location=0, resizable=yes,height="+r;m=m+",width="+a,"Microsoft Internet Explorer"==navigator.appName?(p=document.body.offsetHeight,l=window.screen.availWidth):(p=screen.height,l=screen.width),1==e?(c=n.screenX,u=n.screenY,padAmtX=10,padAmtY=10,u+r+padAmtY>p&&(padAmtY=-1*r-30),c+a+padAmtX>l&&(padAmtX=-1*a-30),"Microsoft Internet Explorer"==navigator.appName?(i=c+padAmtX,s=u+padAmtY):(i=c-pageXOffset+padAmtX,s=u-pageYOffset+padAmtY)):(leftvar=(l-a)/2,rightvar=(p-r)/2,"Microsoft Internet Explorer"==navigator.appName?(i=leftvar,s=rightvar):(i=leftvar-pageXOffset,s=rightvar-pageYOffset)),null!=n&&(m=(m=m+",left="+i)+",top="+s),closePopup(),popupHandle=open(o,t,m)}function show_popup(e,o,t,r,a){var n=window.createPopup(),i=n.document.body;i.style.backgroundColor="#99cc00",i.style.border="solid black 1px",i.innerHTML=a,n.show(e,o,t,r,document.body)}function gravarnodisco(){var e=new ActiveXObject("Scripting.FileSystemObject").CreateTextFile("c:\\testfile.txt",!0);e.WriteLine("This is a test."),e.Close()}function chgAction(e){document.pori.action="s"==e?"cgi/multibase.exe":"cgi/www.exe/[in=pesqger.in]"}function doHighlight(e,o,t,r){t&&r||(t='<font style="color:blue; background-color:yellow;">',r="</font>");for(var a="",n=-1,i=o.toLowerCase(),s=e.toLowerCase();e.length>0;)(n=s.indexOf(i,n+1))<0?(a+=e,e=""):e.lastIndexOf(">",n)>=e.lastIndexOf("<",n)&&s.lastIndexOf("/script>",n)>=s.lastIndexOf("<script",n)&&(a+=e.substring(0,n)+t+e.substr(n,o.length)+r,s=(e=e.substr(n+o.length)).toLowerCase(),n=-1);return a}function Localizar(e){return document.body.innerHTML=doHighlight(document.body.innerHTML,e),!1}function postToURL(e,o){o=o||{};var t=createElement("form",{action:e,method:"POST",style:"display: none"});for(var r in o)if(o.hasOwnProperty(r)){var a=o[r];if(a instanceof Array)for(var n=0,i=a.length;n<i;n++)t.appendChild(createElement("input",{type:"hidden",name:r,value:a[n]}));else t.appendChild(createElement("input",{type:"hidden",name:r,value:a}))}document.body.appendChild(t),t.submit(),document.body.removeChild(t)}function createRequestObject(){return window.XMLHttpRequest?xmlhttprequest=new XMLHttpRequest:window.ActiveXObject?xmlhttprequest=new ActiveXObject("Microsoft.XMLHTTP"):void 0}function getPage(e,o,t,r,a){return goAjax(e+"?"+a+"&rnd"+Math.random(),o,t,r),!1}function goAjax(e,o,t,r){xmlhttp=createRequestObject(),"GET"==o?xmlhttp.open("GET",e,t):(xmlhttp.open("POST",e,t),xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=iso-8859-1"),xmlhttp.setRequestHeader("Cache-Control","no-store, no-cache, must-revalidate"),xmlhttp.setRequestHeader("Cache-Control","post-check=0, pre-check=0"),xmlhttp.setRequestHeader("Pragma","no-cache")),xmlhttp.onreadystatechange=function(){if(4==xmlhttp.readyState)return retorno=xmlhttp.responseText,retorno},"GET"==o?xmlhttp.send(null):xmlhttp.send(r)}function ver_his(){var e=window.location.protocol+window.location.hostname+"/../../../admin/verhis.asp";popup=window.open("","historico","toolbar=no,location=no,directories=no,status=no,scrollbars=yes,resizable=yes,width=670,height=320,left=10,top=15"),ndoc=popup.document,ndoc.location.href=e}String.prototype.trim=function(){return this.replace(/^\s*|\s*$/,"")};var Utf8={encode:function(e){e=e.replace(/\r\n/g,"\n");for(var o="",t=0;t<e.length;t++){var r=e.charCodeAt(t);r<128?o+=String.fromCharCode(r):r>127&&r<2048?(o+=String.fromCharCode(r>>6|192),o+=String.fromCharCode(63&r|128)):(o+=String.fromCharCode(r>>12|224),o+=String.fromCharCode(r>>6&63|128),o+=String.fromCharCode(63&r|128))}return o},decode:function(e){for(var o="",t=0,r=c1=c2=0;t<e.length;)(r=e.charCodeAt(t))<128?(o+=String.fromCharCode(r),t++):r>191&&r<224?(c2=e.charCodeAt(t+1),o+=String.fromCharCode((31&r)<<6|63&c2),t+=2):(c2=e.charCodeAt(t+1),c3=e.charCodeAt(t+2),o+=String.fromCharCode((15&r)<<12|(63&c2)<<6|63&c3),t+=3);return o}};